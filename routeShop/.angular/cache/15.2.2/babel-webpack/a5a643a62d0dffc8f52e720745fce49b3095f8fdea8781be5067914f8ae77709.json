{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (g && (g = 0, op[0] && (_ = 0)), _) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ProductsComponent = void 0;\nvar shopping_cart_service_1 = require(\"../../../shared/services/shopping-cart.service\");\nvar router_1 = require(\"@angular/router\");\nvar product_service_1 = require(\"../../../shared/services/product.service\");\nrequire(\"rxjs/add/operator/switchMap\");\nvar i0 = require(\"@angular/core\");\nvar i1 = require(\"@angular/router\");\nvar i2 = require(\"../../../shared/services/product.service\");\nvar i3 = require(\"../../../shared/services/shopping-cart.service\");\nvar i4 = require(\"./product-filter/product-filter.component\");\nfunction ProductsComponent_div_4_ng_container_1_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 8);\n  }\n}\nfunction ProductsComponent_div_4_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 3);\n    i0.ɵɵelement(2, \"product-card\", 6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, ProductsComponent_div_4_ng_container_1_div_3_Template, 1, 0, \"div\", 7);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    var p_r3 = ctx.$implicit;\n    var i_r4 = ctx.index;\n    var cart_r1 = i0.ɵɵnextContext().ngIf;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"product\", p_r3)(\"shopping-cart\", cart_r1);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (i_r4 + 1) % 2 === 0);\n  }\n}\nfunction ProductsComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 0);\n    i0.ɵɵtemplate(1, ProductsComponent_div_4_ng_container_1_Template, 4, 3, \"ng-container\", 5);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    var ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.filteredProducts);\n  }\n}\nvar ProductsComponent = /** @class */function () {\n  function ProductsComponent(route, productService, shoppingCartService) {\n    this.route = route;\n    this.productService = productService;\n    this.shoppingCartService = shoppingCartService;\n    this.products = [];\n    this.filteredProducts = [];\n  }\n  ProductsComponent.prototype.ngOnInit = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            _a = this;\n            return [4 /*yield*/, this.shoppingCartService.getCart()];\n          case 1:\n            _a.cart$ = _b.sent();\n            this.populateProducts();\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  ProductsComponent.prototype.populateProducts = function () {\n    var _this = this;\n    this.productService.getAll().switchMap(function (products) {\n      _this.products = products;\n      return _this.route.queryParamMap;\n    }).subscribe(function (params) {\n      _this.category = params.get('category');\n      _this.applyFilter();\n    });\n  };\n  ProductsComponent.prototype.applyFilter = function () {\n    var _this = this;\n    this.filteredProducts = this.category ? this.products.filter(function (p) {\n      return p.category === _this.category;\n    }) : this.products;\n  };\n  ProductsComponent.ɵfac = function ProductsComponent_Factory(t) {\n    return new (t || ProductsComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.ProductService), i0.ɵɵdirectiveInject(i3.ShoppingCartService));\n  };\n  ProductsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProductsComponent,\n    selectors: [[\"app-products\"]],\n    decls: 6,\n    vars: 4,\n    consts: [[1, \"row\"], [1, \"col-3\"], [3, \"category\"], [1, \"col\"], [\"class\", \"row\", 4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"product\", \"shopping-cart\"], [\"class\", \"w-100\", 4, \"ngIf\"], [1, \"w-100\"]],\n    template: function ProductsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵelement(2, \"product-filter\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵtemplate(4, ProductsComponent_div_4_Template, 2, 1, \"div\", 4);\n        i0.ɵɵpipe(5, \"async\");\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"category\", ctx.category);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(5, 2, ctx.cart$));\n      }\n    },\n    dependencies: [i4.ProductFilterComponent],\n    styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n  return ProductsComponent;\n}();\nexports.ProductsComponent = ProductsComponent;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;AAEA;AACA;AAEAA;;;;;;;;ICIUC,yBAAmD;;;;;IAJrDA,6BAAgE;IAC9DA,8BAAiB;IACfA,kCAAkE;IACpEA,iBAAM;IACNA,uFAAmD;IACrDA,0BAAe;;;;;;IAHGA,eAAa;IAAbA,8BAAa;IAEvBA,eAAuB;IAAvBA,2CAAuB;;;;;IALnCA,8BAA+C;IAC3CA,0FAKe;IACjBA,iBAAM;;;;IANwBA,eAAqB;IAArBA,iDAAqB;;;ADEzD;EAWE,2BACUC,KAAqB,EACrBC,cAA8B,EAC9BC,mBAAwC;IAFxC,UAAK,GAALF,KAAK;IACL,mBAAc,GAAdC,cAAc;IACd,wBAAmB,GAAnBC,mBAAmB;IAR7B,aAAQ,GAAc,EAAE;IACxB,qBAAgB,GAAc,EAAE;EAShC;EAEMC,oCAAQ,GAAd;;;;;;YACEC,SAAI;YAAS,qBAAM,IAAI,CAACF,mBAAmB,CAACG,OAAO,EAAE;;YAArDD,GAAKE,KAAK,GAAGC,SAAwC;YACrD,IAAI,CAACC,gBAAgB,EAAE;;;;;GACxB;;EAEOL,4CAAgB,GAAxB;IAAA;IACE,IAAI,CAACF,cAAc,CAChBQ,MAAM,EAAE,CACRC,SAAS,CAAC,kBAAQ;MACjBC,KAAI,CAACC,QAAQ,GAAGA,QAAQ;MACxB,OAAOD,KAAI,CAACX,KAAK,CAACa,aAAa;IACjC,CAAC,CAAC,CACDC,SAAS,CAAC,gBAAM;MACfH,KAAI,CAACI,QAAQ,GAAGC,MAAM,CAACC,GAAG,CAAC,UAAU,CAAC;MACtCN,KAAI,CAACO,WAAW,EAAE;IACpB,CAAC,CAAC;EACN,CAAC;EAGOf,uCAAW,GAAnB;IAAA;IACE,IAAI,CAACgB,gBAAgB,GAAI,IAAI,CAACJ,QAAQ,GACtC,IAAI,CAACH,QAAQ,CAACQ,MAAM,CAAC,WAAC;MAAI,QAAC,CAACL,QAAQ,KAAKJ,KAAI,CAACI,QAAQ;IAA5B,CAA4B,CAAC,GACvD,IAAI,CAACH,QAAQ;EACf,CAAC;;qBApCUT,iBAAiB;EAAA;;UAAjBA,iBAAiB;IAAAkB;IAAAC;IAAAC;IAAAC;IAAAC;MAAA;QCb9B1B,8BAAiB;QAEbA,oCAAuD;QACzDA,iBAAM;QACNA,8BAAiB;QACfA,kEAOQ;;QACVA,iBAAM;;;QAXYA,eAAqB;QAArBA,uCAAqB;QAGnBA,eAAoB;QAApBA,sDAAoB;;;;;;0BDN1C;CAmDC,EA1CD;AAKa2B","names":["require","i0","route","productService","shoppingCartService","ProductsComponent","_a","getCart","cart$","_b","populateProducts","getAll","switchMap","_this","products","queryParamMap","subscribe","category","params","get","applyFilter","filteredProducts","filter","selectors","decls","vars","consts","template","exports"],"sourceRoot":"","sources":["C:\\Angular\\routeShop\\src\\app\\shopping\\components\\products\\products.component.ts","C:\\Angular\\routeShop\\src\\app\\shopping\\components\\products\\products.component.html"],"sourcesContent":["import { ShoppingCart } from '../../../shared/models/shopping-cart';\nimport { Observable } from 'rxjs/Observable';\nimport { ShoppingCartService } from '../../../shared/services/shopping-cart.service';\nimport { Product } from '../../../shared/models/product';\nimport { ActivatedRoute } from '@angular/router';\nimport { ProductService } from '../../../shared/services/product.service';\nimport { Component, OnInit } from '@angular/core';\nimport 'rxjs/add/operator/switchMap';\n\n@Component({\n  selector: 'app-products',\n  templateUrl: './products.component.html',\n  styleUrls: ['./products.component.css']\n})\nexport class ProductsComponent implements OnInit  {\n  products: Product[] = [];\n  filteredProducts: Product[] = [];\n  category: string;\n  cart$: Observable<ShoppingCart>;\n\n  constructor(\n    private route: ActivatedRoute,\n    private productService: ProductService,\n    private shoppingCartService: ShoppingCartService\n  ) {\n  }\n\n  async ngOnInit() {\n    this.cart$ = await this.shoppingCartService.getCart();\n    this.populateProducts();\n  }\n\n  private populateProducts() { \n    this.productService\n      .getAll()\n      .switchMap(products => {\n        this.products = products;\n        return this.route.queryParamMap;\n      })\n      .subscribe(params => {\n        this.category = params.get('category');\n        this.applyFilter();      \n      });\n  }\n\n\n  private applyFilter() { \n    this.filteredProducts = (this.category) ? \n    this.products.filter(p => p.category === this.category) : \n    this.products;\n  }\n}\n","\n<div class=\"row\">\n  <div class=\"col-3\">\n    <product-filter [category]=\"category\"></product-filter>\n  </div>\n  <div class=\"col\">\n    <div class=\"row\" *ngIf=\"cart$ | async as cart\">\n        <ng-container *ngFor=\"let p of filteredProducts; let i = index\">\n          <div class=\"col\">\n            <product-card [product]=\"p\" [shopping-cart]=\"cart\"></product-card>\n          </div>\n          <div *ngIf=\"(i + 1) % 2 === 0\" class=\"w-100\"></div>\n        </ng-container>\n      </div>\n  </div>\n</div>\n\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}